"use strict";const nameRecipe=document.querySelector(".main-title"),listIngredients=document.querySelector(".list-ingredients"),buttonSelect=document.querySelector(".button-select"),buttonRemove=document.querySelector(".button-unselect"),numberItems=document.querySelector(".number-items"),subtotal=document.querySelector(".subtotal"),delivery=document.querySelector(".delivery"),total=document.querySelector(".total"),submitPurchaseButton=document.querySelector(".submit__purchase-button"),submitPurchaseAmount=document.querySelector(".submit__purchase-amount");let recipeData,ingredients,checkboxList,inputQuantityList,itemPriceList,counterIngredients,counterSubtotal,counterDeliveryCharges,counterTotal=0;function printArticles(){nameRecipe.innerHTML=recipeData.name,ingredients.map((e,t)=>{const n=document.createElement("li");n.classList.add("listItem","list-group-item","d-flex","align-items-center","row","p-1"),n.setAttribute("id",t);const i=document.createElement("div");i.classList.add("col-1","d-flex","justify-content-center");const c=document.createElement("input");c.type="checkbox",c.setAttribute("name","ingredient"),c.classList.add("checkbox-ingredient"),c.addEventListener("change",handleCheckbox),c.setAttribute("id",t),i.appendChild(c);const r=document.createElement("input");r.type="number",r.setAttribute("name","quantity-ingredient"),r.addEventListener("keyup",handleInputQuantity),r.addEventListener("change",handleInputQuantity),r.classList.add("counter-data","d-flex","text-center","col-1","border","p-0"),r.value=e.items,r.setAttribute("id",t);const s=document.createElement("div");s.classList.add("ingredient-data-container"),s.classList.add("col-8");const a=document.createElement("p");a.classList.add("m-0","font-weight-bold"),a.innerHTML=e.product;const o=document.createElement("p");o.classList.add("m-0","text-secondary","small"),o.innerHTML=e.brand||"";const u=document.createElement("p");u.classList.add("m-0","small"),u.innerHTML=e.quantity;const d=document.createElement("div");d.classList.add("price-container","col-2","d-flex","justify-content-center","align-self-center");const l=document.createElement("p");l.classList.add("price-item","text-success","font-weight-bold"),l.innerHTML=e.price+"€",d.appendChild(l),s.append(a,o,u),n.append(i,r,s,d),listIngredients.appendChild(n)}),checkboxList=document.querySelectorAll(".checkbox-ingredient"),inputQuantityList=document.querySelectorAll(".counter-data"),itemPriceList=document.querySelectorAll(".price-item"),updatePurchaseData()}function updatePurchaseData(){counterIngredients=0,counterSubtotal=0,counterTotal=0;for(let e=0;e<ingredients.length;e++){const t=parseInt(ingredients[e].items);counterIngredients+=t;const n=ingredients[e].price*t;itemPriceList[e].innerHTML=Math.round(100*n)/100+"€",counterSubtotal+=n}counterTotal=counterSubtotal+(counterDeliveryCharges=0===counterIngredients?0:7),numberItems.innerHTML=counterIngredients,subtotal.innerHTML=Math.round(100*counterSubtotal)/100+" €",delivery.innerHTML=counterDeliveryCharges+" €",total.innerHTML=Math.round(100*counterTotal)/100+" €",submitPurchaseAmount.innerHTML=Math.round(100*counterTotal)/100+" €"}function handleCheckbox(e){const t=e.target,n=e.target.id;!1===t.checked?(ingredients[n].items=0,inputQuantityList[n].value=ingredients[n].items):(ingredients[n].items=1,inputQuantityList[n].value=ingredients[n].items),updatePurchaseData()}function handleInputQuantity(e){const t=e.target.value,n=e.target.id;""===t?(ingredients[n].items=0,checkboxList[n].checked=!1):(ingredients[n].items=t,checkboxList[n].checked=!0),updatePurchaseData()}function addAllIngredients(){for(let e=0;e<checkboxList.length;e++)ingredients[e].items=1,inputQuantityList[e].value=ingredients[e].items,checkboxList[e].checked=!0;updatePurchaseData()}function removeAllIngredients(){for(let e=0;e<checkboxList.length;e++)ingredients[e].items=0,inputQuantityList[e].value=ingredients[e].items,checkboxList[e].checked=!1;updatePurchaseData()}function submitPurchase(){counterTotal>0?(console.log(ingredients),alert("Gracias por su compra")):alert("No ha seleccionado ningún producto. Por favor, seleccione algún producto")}fetch("https://raw.githubusercontent.com/Adalab/recipes-data/master/rissoto-setas.json").then(e=>e.json()).then(e=>{recipeData=e.recipe,ingredients=recipeData.ingredients,printArticles()}),buttonSelect.addEventListener("click",addAllIngredients),buttonRemove.addEventListener("click",removeAllIngredients),submitPurchaseButton.addEventListener("click",submitPurchase);